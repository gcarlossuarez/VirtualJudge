<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Status del Contest</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 6px 10px; text-align: left; }
    th { background: #f0f0f0; }
    .ok { color: green; font-weight: bold; }
    .fail { color: red; font-weight: bold; }
  </style>
</head>
<body>
  <h1 id="title">ðŸ“Š Status del Contest</h1>
  <table id="status">
    <thead>
      <tr>
        <th>Estudiante</th>
        <th>Problema</th>
        <th>Correcto</th>
        <th>Fecha</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
  async function loadStatus() {
    const res = await fetch("/api/contest-status");
    const data = await res.json();

    const tbody = document.querySelector("#status tbody");
    tbody.innerHTML = "";

    if (data.length > 0) {
      document.getElementById("title").textContent =
        `ðŸ“Š Status del Contest #${data[0].contestId} (${new Date(data[0].contestDate).toLocaleDateString()})`;
    }

    data.forEach(row => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${row.student}</td>
        <td>${row.problemId}</td>
        <td class="${row.isCorrect ? 'ok' : 'fail'}">
          ${row.isCorrect ? "âœ”" : "âœ˜"}
        </td>
        <td>${new Date(row.createdAt).toLocaleString()}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  loadStatus();
  setInterval(loadStatus, 10000);
  </script>
</body>
</html>
